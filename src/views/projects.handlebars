<!DOCTYPE html>
<!-- saved from url=(0052)https://getbootstrap.com/docs/4.0/examples/pricing/# -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>Reportal</title>
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/projects_choice.css" rel="stylesheet">

  </head>

  <body>
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">New project</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form name="new_project" action="javascript:addProject()">
              <div class="form-group">
                <label for="recipient-name" class="col-form-label">Project name:</label>
                <input name="project_name" type="text" class="form-control" id="recipient-name">
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary">Save changes</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom box-shadow">
      <h5 class="my-0 mr-md-auto font-weight-normal">Reportal</h5>
      <nav class="my-2 my-md-0 mr-md-3">
        <button type="button" class="btn btn-light" data-toggle="modal" data-target="#exampleModal">
          <img class=""src="assets/add-item.svg" alt="" width="20" height="20">
          Add new project
        </button>
      </nav>
      <button class="btn btn-outline-primary" style="color: #343a40;" onclick="logout();">Sign out</button>
    </div>

    <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
        {{#if projects}}
            <h1 class="display-5">Select project</h1>
            <p class="lead">Select project to view reports</p>
        {{else}}
            <a href="#exampleModal" data-toggle="modal" data-target="#exampleModal" style="font-size: 20px">Add new project to start</a>
        {{/if}}
    </div>

    <div class="container">


      <div class="list-group">
          {{#each projects}}
              <a href="#" class="list-group-item list-group-item-action">{{this.name}}</a>
          {{/each}}
      </div>
    </div>
    <script>
      function logout() {
        const form = document.createElement('form');
        form.setAttribute('method', 'post');
        form.setAttribute('action', '/logout');
        form.style.display = 'hidden';
        document.body.appendChild(form);
        form.submit();
      }
    function addProject() {
      $('#exampleModal').on('hidden.bs.modal', function(e) {
        $('[name="project_name"]').val('');
        $('[name="project_description"]').val('');
      });

      const xhr = new XMLHttpRequest();
      xhr.open("POST", "/project", true);
      xhr.setRequestHeader('Content-type', 'application/json; charset=utf-8');
      xhr.onload = function () {
        if (xhr.status === 200){
          console.log($('#exampleModal'));
          $('#exampleModal').modal('hide');
        } else {
          console.error(xhr.status);

        }
      };
      xhr.onerror = xhr.onabort = function (){
        console.error('some error');
      };
      const addProjectForm = document.forms.new_project;
      xhr.send(JSON.stringify({name: addProjectForm.elements.project_name.value}));
    }
    </script>
</body></html>